[Actions]
requiredWinstVersion >= "4.10.8.12"
Message=opsi configuration script
ShowBitmap "%scriptpath%\opsi.png" "setprod2setup"

DefVar $INST_Paramstr$
DefVar $INST_ClientId$
DefVar $INST_Service_Password$
DefVar $INST_Service_Address$
DefVar $INST_OpsiclientdConf$


Set $INST_Paramstr$=PARAMSTR
set $INST_OpsiclientdConf$="%ProgramFiles32Dir%\opsi.org\opsi-client-agent\opsiclientd\opsiclientd.conf"
Set $INST_Service_Password$  = GetvalueFromInifile($INST_OpsiclientdConf$, "global", "opsi_host_key", "")
Set $INST_ClientId$          = GetvalueFromInifile($INST_OpsiclientdConf$, "global", "host_id", "")
Set $INST_Service_Address$   = GetvalueFromInifile($INST_OpsiclientdConf$, "config_service", "url", "")


opsiservicecall_setProductActionRequest /username $INST_ClientId$ /password $INST_Service_Password$ /serviceurl $INST_Service_Address$

[opsiservicecall_setProductActionRequest]
"method": "setProductActionRequest"
"params": [
					"$INST_Paramstr$",
					"$INST_ClientId$",
					"setup"
					]
